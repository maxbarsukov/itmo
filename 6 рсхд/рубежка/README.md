# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

## –†—É–±–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞

<img alt="k-on-test" src="https://github.com/maxbarsukov/itmo/blob/master/.docs/k-on-test.gif" height="300">

> [!TIP]
> Everybody keeps talking about the SQL, but i've never seen the PREQL

---

## –í–∞—Ä–∏–∞–Ω—Ç

### –ü–µ—Ä–≤—ã–π –ø–æ—Ç–æ–∫

–í–∞—Ä–∏–∞–Ω—Ç –∫–∞–∂–¥–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ò–°–£: \
`sXXXXAB`

1. –í–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ 1: `B`
2. –í–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ 2: `(A + B) % 10`
3. –í–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –∑–∞–¥–∞–Ω–∏—è 3: `B % 2`

### –í—Ç–æ—Ä–æ–π –ø–æ—Ç–æ–∫

*TODO*

---

## –ó–∞–¥–∞–Ω–∏–µ

### –í–æ–ø—Ä–æ—Å 1

<details>
  <summary>üì∏ <b>–§–æ—Ç–æ –≤–æ–ø—Ä–æ—Å–∞ 1</b></summary>

  <img alt="–†—É–±–µ–∂–∫–∞. –í–æ–ø—Ä–æ—Å 1." src="./img/task-1.jpeg">
</details>

0. PostgreSQl: template0, template1, –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã.
1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ PostgreSQL.
2. –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å PostgreSQL.
3. –ë—É—Ñ–µ—Ä–Ω–∞—è –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ PostgreSQL.
4. –ü—Ä–æ—Ü–µ—Å—Å—ã, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–µ —Ä–∞–±–æ—Ç—É PostgreSQL.
5. –°–∏—Å—Ç–µ–º–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è, —Å–ø–æ—Å–æ–±—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
6. –°—Ö–µ–º–∞, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å–æ —Å—Ö–µ–º–∞–º–∏ PostgreSQL, search_path.
7. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ –¥–∞–Ω–Ω—ã–º –≤ PostgreSQL, –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏.
8. –†–æ–ª–∏ –≤ PostgreSQL. INHERIT, NOINHERIT.
9. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PostgreSQL.

### –í–æ–ø—Ä–æ—Å 2

<details>
  <summary>üì∏ <b>–§–æ—Ç–æ –≤–æ–ø—Ä–æ—Å–∞ 2</b></summary>

  <img alt="–†—É–±–µ–∂–∫–∞. –í–æ–ø—Ä–æ—Å 2." src="./img/task-2.jpeg">
</details>

0. –ò–∑–æ–ª—è—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –†–µ–∂–∏–º—ã –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.
1. PostgreSQL, —Å–æ–∑–¥–∞–Ω–∏–µ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö.
2. –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL.
3. –¢–∞–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.
4. VACCUM.
5. steal/no-steal, force/no-force. ARIES.
6. –õ–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.
7. –§–∏–∑–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ.
8. UNDO-–∂—É—Ä–Ω–∞–ª.
9. REDO-–∂—É—Ä–Ω–∞–ª.

### –ó–∞–¥–∞–Ω–∏–µ 3

<details>
  <summary>üì∏ <b>–§–æ—Ç–æ –∑–∞–¥–∞–Ω–∏—è 3</b></summary>

  <img alt="–†—É–±–µ–∂–∫–∞. –ó–∞–¥–∞–Ω–∏–µ 3." src="./img/task-3.jpeg">
</details>

–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –≤ –ë–î Education (–≤ PostgreSQL) –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Äì `student1`, `student2`, `teacher`. –¢–∞–∫–∂–µ –≤ –ë–î Education —Å–æ–∑–¥–∞–Ω—ã —Ç–∞–±–ª–∏—Ü—ã `Groups` (–≤ —Å—Ö–µ–º–µ `studs`) –∏ `Exams` (–≤ —Å—Ö–µ–º–∞—Ö `studs` –∏ `test`). –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ —É `student1`, `student2` –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-–ª–∏–±–æ —Ç–∞–±–ª–∏—Ü (–≤ —Ç–æ–º —á–∏—Å–ª–µ `Groups`, `Exams`), `teacher` ‚Äì –∏–º–µ–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **–¥–æ–±–∞–≤–ª—è—Ç—å** –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã.

–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤—Å–µ—Ö —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Å –æ–ø–∏—Å–∞–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏) –∏ –æ–ø–∏—à–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã), —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î –∏:

- **–í–∞—Ä–∏–∞–Ω—Ç 0)** –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ `student1`, `student2` –º–æ–≥–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Exams`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `student2` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Groups` (y `student1` –Ω–µ—Ç —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏). –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äì –¢–°P/I–†, –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–í–∞—Ä–∏–∞–Ω—Ç 1)** –ø—Ä–∏ —ç—Ç–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `student2` –º–æ–≥ –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Exams`; –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `student1` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Groups` (y `student2` –Ω–µ—Ç —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏). –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Äì –¢–°–†/I–†, –ø–æ –ø–∞—Ä–æ–ª—é.

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è: **–Ω–µ–ª—å–∑—è** –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–∞–∫–∏—Ö-–ª–∏–±–æ —Ç–∞–±–ª–∏—Ü –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º ‚Äì `student1`, `student2`.

---

## –†–∞–∑–±–æ—Ä

### –ó–∞–¥–∞–Ω–∏–µ 3.

#### –í–∞—Ä–∏–∞–Ω—Ç 0

- `student1` –∏ `student2` –º–æ–≥—É—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Exams`;
- `student2` –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Groups` (—É `student1` —Ç–∞–∫–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–µ—Ç);
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ TCP/IP —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –ø–∞—Ä–æ–ª—è).

**1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π**

```sql
CREATE USER student1;
CREATE USER student2;
CREATE USER teacher WITH PASSWORD 'teacher_password';

GRANT USAGE ON SCHEMA studs TO student1, student2, teacher;
GRANT USAGE ON SCHEMA test TO teacher;

CREATE ROLE exams_access;
CREATE ROLE groups_access;

GRANT INSERT, UPDATE, DELETE ON studs.Exams TO exams_access;
GRANT INSERT, UPDATE, DELETE ON studs.Groups TO groups_access;

GRANT exams_access TO student1, student2;
GRANT groups_access TO student2;

GRANT INSERT ON studs.Groups, studs.Exams, test.Exams TO teacher;
```

**2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

–î–æ–±–∞–≤–∏–º –≤ —Ñ–∞–π–ª `pg_hba.conf`:

```conf
# TYPE  DATABASE     USER        ADDRESS     METHOD
host    education    student1    0.0.0.0/0   trust  # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –∏–º–µ–Ω–∏
host    education    student2    0.0.0.0/0   trust
host    education    teacher     0.0.0.0/0   md5    # –î–ª—è teacher —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–∞—Ä–æ–ª—å
```

–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–º PostgreSQL:

    pg_ctl reload -D $PGDATA

#### –í–∞—Ä–∏–∞–Ω—Ç 1

- `student2` –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Exams`;
- `student1` –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ç–∞–±–ª–∏—Ü—É `studs.Groups`;
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ TCP/IP —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ –ø–∞—Ä–æ–ª—é.

**1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–æ–ª–µ–π**

```sql
CREATE USER student1 WITH PASSWORD 'password1';
CREATE USER student2 WITH PASSWORD 'password2';
CREATE USER teacher WITH PASSWORD 'teacher_password';

GRANT USAGE ON SCHEMA studs TO student1, student2, teacher;
GRANT USAGE ON SCHEMA test TO teacher;

CREATE ROLE update_exams_role;
CREATE ROLE update_groups_role;

GRANT INSERT, UPDATE, DELETE ON studs.Exams TO update_exams_role;
GRANT INSERT, UPDATE, DELETE ON studs.Groups TO update_groups_role;

GRANT update_groups_role TO student1;
GRANT update_exams_role TO student2;

GRANT INSERT ON studs.Groups, studs.Exams, test.Exams TO teacher;
```

**2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

–î–æ–±–∞–≤–∏–º –≤ —Ñ–∞–π–ª `pg_hba.conf`:

```conf
# TYPE  DATABASE     USER        ADDRESS     METHOD
host    education    student1    0.0.0.0/0   md5  # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –ø–∞—Ä–æ–ª—é
host    education    student2    0.0.0.0/0   md5
host    education    teacher     0.0.0.0/0   md5
```

–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–º PostgreSQL:

    pg_ctl reload -D $PGDATA

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

| –°—Å—ã–ª–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
| --- | --- |
| [–ª–µ–∫—Ü–∏–∏/](../–ª–µ–∫—Ü–∏–∏/) | –°—Ç–æ–∏—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª–µ–∫—Ü–∏–∏ –¥–æ –ª–µ–∫—Ü–∏–∏ 6 —á–∞—Å—Ç—å II **–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ** |
| [github.com/Imtjl/distributed-storage-systems/frontier-prep](https://github.com/Imtjl/distributed-storage-systems/tree/master/frontier-prep) | –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —Ä—É–±–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∏ –ø–µ—Å–æ—á–Ω–∏—Ü–∞ PostgreSQL –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ |
| [github.com/RedGry/ITMO/RSHD/rybej_var1.jpg](https://github.com/RedGry/ITMO/blob/master/RSHD/tests/img/rybej_var1.jpg) | –†—É–±–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2023 |
| [postgrespro.ru/docs/postgresql/17/user-manag](https://postgrespro.ru/docs/postgresql/17/user-manag) <br> [sql-ex.ru/blogs/PostgreSQL_roli_i_privilegii.html](https://sql-ex.ru/blogs/?/Osnovy_PostgreSQL_roli_i_privilegii.html) | –†–æ–ª–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏, –¥–ª—è –∑–∞–¥–∞–Ω–∏—è 3 |

## –õ–∏—Ü–µ–Ω–∑–∏—è <a name="license"></a>

–ü—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –Ω–∞ —É—Å–ª–æ–≤–∏—è—Ö [–õ–∏—Ü–µ–Ω–∑–∏–∏ GNU GPL 3](https://opensource.org/license/gpl-3-0/). \
*–ê–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ 2025 Max Barsukov*

**–ü–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É :star:, –µ—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–Ω—ã–º.**
